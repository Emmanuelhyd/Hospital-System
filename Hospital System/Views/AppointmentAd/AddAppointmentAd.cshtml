@model Hospital_System.Dash.DashboardDetails@{    ViewBag.Title = "Add Appointment";    //Layout = "~/Views/Shared/_LayoutAdmin.cshtml";    Layout = "~/Views/Shared/_LayoutTech.cshtml";}<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">@using (Html.BeginForm("AddAppointmentAd", "AppointmentAd")){<div class="sb2-2" style="height: 110%; position: absolute; margin-top: 65px;">    <div class="sb2-2-2" style="margin-left:30px;">        <ul>            <li>                <a href="/Dashboard/DashboardView"><i class="fa fa-home" aria-hidden="true"></i> Home</a>            </li>            <li class="active-bre">                <a href="#"> Shedules</a>            </li>            <li class="page-back">                <a href="/Dashboard/DashboardView"><i class="fa fa-backward" aria-hidden="true"></i> Back</a>            </li>        </ul>    </div></div><div style="padding: 14px 36px; background: #002147; margin-top:145px; margin-left: 25%; width: 70%; color:white;position:absolute;">    <h4 style="color:white;font-size:20px;">Add Appointments</h4></div><div class="form-container">    <!-- Row 1: ID and Patient Name -->    <div class="form-row">        <div class="form-group">            <label for="Id">Id</label>            @Html.TextBoxFor(m => m.MAppointmentAd.Id, new { @class = "form-control", @placeholder = "Enter Id" })            @Html.ValidationMessageFor(m => m.MAppointmentAd.Id, "", new { @class = "text-danger" })        </div>        <div class="form-group">            <label for="PatientName">Patient Name</label>            @Html.TextBoxFor(m => m.MAppointmentAd.PatientName, new            {                @class = "form-control",                @placeholder = "PatientName ",                @required = "required",                @pattern = "^[A-Za-z\\s]+$",                @title = "Please enter a valid name (letters and spaces only)"            })        </div>    </div>    <!-- Row 2: Gender and Department -->    <div class="form-row">        <div class="form-group">            <label for="Gender">Gender</label>            @Html.DropDownListFor(m => m.MAppointmentAd.Gender, new SelectList(new List<SelectListItem>{                        new SelectListItem { Value = "Male", Text = "Male" },                        new SelectListItem { Value = "Female", Text = "Female" },                        new SelectListItem { Value = "Others", Text = "Others" },                    }, "Value", "Text"), "Select Gender", new { @class = "form-control", @required = "required" })        </div>        <div class="form-group">            <label for="Department">Department</label>            @Html.DropDownListFor(m => m.MAppointmentAd.Department, new SelectList(new List<SelectListItem>{                     new SelectListItem{Value="General Medicine",Text="General Medicine"},                     new SelectListItem { Value = "Cardiology", Text = "Cardiology" },                     new SelectListItem { Value = "Neurology", Text = "Neurology" },                     new SelectListItem { Value = "Orthopedics", Text = "Orthopedics" },                     new SelectListItem { Value = "Pediatrics", Text = "Pediatrics" },                     new SelectListItem { Value = "Emergency", Text = "Emergency" },                     new SelectListItem { Value = "Oncology", Text = "Oncology" },                     new SelectListItem { Value = "Radiology", Text = "Radiology" },                     new SelectListItem { Value = "Dermatology", Text = "Dermatology" }                 }, "Value", "Text"), "Select Department", new { @required = "required", @class = "form-control" })            @Html.ValidationMessageFor(m => m.MAppointmentAd.Department, "", new { @class = "text-danger" })        </div>    </div>    <!-- Row 3: Problem and Doctor Name -->    <div class="form-row">        <div class="form-group">            <label for="Problem">Problem</label>            @Html.TextBoxFor(m => m.MAppointmentAd.Problem, new            {                @class = "form-control",                @placeholder = "Problem ",                @required = "required",                @pattern = "^[A-Za-z\\s]+$",                @title = "Please enter a valid name (letters and spaces only)"            })            @Html.ValidationMessageFor(m => m.MAppointmentAd.Problem, "", new { @class = "text-danger" })        </div>        <div class="form-group">            <label for="DoctorName">Doctor Name</label>            @Html.TextBoxFor(m => m.MAppointmentAd.DoctorName, new            {                @class = "form-control",                @placeholder = "DoctorName ",                @required = "required",                @pattern = "^[A-Za-z\\s]+$",                @title = "Please enter a valid name (letters and spaces only)"            })            @Html.ValidationMessageFor(m => m.MAppointmentAd.DoctorName, "", new { @class = "text-danger" })        </div>    </div>    <!-- Row 4: Phone Number and Address -->    <div class="form-row">        <div class="form-group">            <label for="PhoneNumber">Phone Number</label>            @Html.TextBoxFor(m => m.MAppointmentAd.PhoneNumber, new            {                @class = "form-control",                @required = "required",                @placeholder = "Enter Phone Number",                @pattern = @"^[6789]\d{9}$",                @title = "Enter a valid 10-digit phone number starting with 7, 8, or 9."            })            @Html.ValidationMessageFor(m => m.MAppointmentAd.PhoneNumber, "", new { @class = "text-danger" })        </div>        <div class="form-group">            <label for="Address">Address</label>            @Html.TextBoxFor(m => m.MAppointmentAd.Address, new { @class = "form-control", @required = "required", @placeholder = "Enter Address" })            @Html.ValidationMessageFor(m => m.MAppointmentAd.Address, "", new { @class = "text-danger" })        </div>    </div>    <!-- Row 5: Date and Time -->    <!-- Row 5: Date and Time -->    <div class="form-row">        <div class="form-group">            <label for="Date">Date</label>            @Html.TextBoxFor(m => m.MAppointmentAd.Date, new { @class = "form-control", @required = "required", @placeholder = "Appointment Date", @type = "date", id = "appointmentDate" })            @Html.ValidationMessageFor(m => m.MAppointmentAd.Date, "", new { @class = "text-danger" })        </div>        <div class="form-group">            <label for="Time">Time</label>            @Html.DropDownListFor(m => m.MAppointmentAd.Time, new SelectList(Enumerable.Empty<SelectListItem>(), "Value", "Text"), "Select Time", new { @required = "required", @class = "form-control", id = "appointmentTime" })            @Html.ValidationMessageFor(m => m.MAppointmentAd.Time, "", new { @class = "text-danger" })        </div>    </div>    <!-- Row 6: Description -->    <div class="form-row">        <div class="form-group">            <label for="Description">Description</label>            @Html.TextBoxFor(m => m.MAppointmentAd.Description, new            {                @class = "form-control",                @placeholder = "Description ",                @required = "required",                @pattern = "^[A-Za-z\\s]+$",                @title = "Please enter a valid name (letters and spaces only)"            })            @Html.ValidationMessageFor(m => m.MAppointmentAd.Description, "", new { @class = "text-danger" })        </div>    </div>    <div style="display: flex; justify-content: center; ">        <input type="submit" class="btn-submit" value="Submit" style="border-color: #e74715">    </div></div>}<style>    .form-container {        position: absolute;        width: 70%;        margin-top: 197px;        /*margin: 30px auto;*/        /*padding: 20px;*/        /border-radius: 8px;        / box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);        background-color: #ffffff;        margin-left: 25%;    }    .form-row {        display: flex;        flex-wrap: wrap;        gap: 20px;    }    .form-group {        flex: 1;        min-width: 250px;        margin-bottom: 5px;        margin-left: 30px;    }        .form-group label {            font-weight: bold;            margin-bottom: 5px;            display: block;        }    .form-control {        width: 95%;        padding: 10px;        border: 1px solid #ccc;        border-radius: 4px;        box-sizing: border-box;        height: 42px;    }        .form-control:focus {            border-color: #007bff;            outline: none;            box-shadow: 0 0 5px rgba(0, 123, 255, .6);        }    .btn-primary {        background-color: #007bff;        border: none;        color: white;        padding: 10px 15px;        border-radius: 4px;        cursor: pointer;        width: 100%;    }        .btn-primary:hover {            background-color: #0056b3;        }    .text-danger {        color: #dc3545;    }    .validation-summary {        margin-bottom: 15px;        color: #dc3545;    }    .btn {        color: white;        background-color: dodgerblue;        border: none;        border-radius: 5px;        padding: 10px 15px;        cursor: pointer;        display: flex;        align-items: center;        justify-content: center;        width: 30%;    }        .btn:hover {            background-color: #0056b3;        }</style><script>    window.onload = function () {        var dropdown = document.getElementById("appointmentTime");        var appointmentDate = document.getElementById("appointmentDate");        // Ensure dropdown and date field exist        if (!dropdown || !appointmentDate) {            console.error("Appointment Time dropdown or Appointment Date field not found.");            return;        }        // Initialize time slots when the page loads        updateTimeSlots();        // Event listener for when the date changes        appointmentDate.addEventListener('change', function () {            updateTimeSlots();        });    };    // Function to update available time slots based on the selected date    function updateTimeSlots() {        var dropdown = document.getElementById("appointmentTime");        var appointmentDate = document.getElementById("appointmentDate");        // Get today's date and the selected date        var today = new Date();        var selectedDate = new Date(appointmentDate.value);        // Clear existing dropdown options        dropdown.innerHTML = '';        // Insert "Select Time" option at the top        var selectOption = document.createElement("option");        selectOption.value = "";        selectOption.text = "Select Time";        dropdown.appendChild(selectOption);        // Check if the selected date is tomorrow        if (isTomorrow(today, selectedDate)) {            // If tomorrow, populate all time slots from 9 AM to 5 PM            populateAllTimeSlots(dropdown);        } else if (selectedDate > today) {            // If a future date is selected (not today or tomorrow), populate all time slots            populateAllTimeSlots(dropdown);        } else {            // If today, populate available time slots from current time onward            populateAvailableTimeSlots(dropdown);        }    }    // Function to check if the selected date is tomorrow    function isTomorrow(today, selectedDate) {        var tomorrow = new Date(today);        tomorrow.setDate(today.getDate() + 1);        return selectedDate.toDateString() === tomorrow.toDateString();    }    // Function to populate all time slots from 9 AM to 5 PM    function populateAllTimeSlots(dropdown) {        var startTime = new Date();        startTime.setHours(9, 0, 0, 0); // Start at 9:00 AM        var endTime = new Date();        endTime.setHours(17, 0, 0, 0); // End at 5:00 PM        // Loop through time slots in 15-minute intervals        while (startTime < endTime) {            var endSlot = new Date(startTime.getTime() + 15 * 60000); // Add 15 minutes            var timeRange = formatTime(startTime) + " - " + formatTime(endSlot);            var option = document.createElement("option");            option.value = timeRange;            option.text = timeRange;            dropdown.appendChild(option);            startTime = endSlot; // Move to the next interval        }    }    // Function to populate available time slots based on the current time    function populateAvailableTimeSlots(dropdown) {        var startTime = new Date();        startTime.setMinutes(Math.ceil(startTime.getMinutes() / 15) * 15);  // Round to the next 15-minute interval        startTime.setSeconds(0); // Set seconds to 0 for consistency        var endTime = new Date();        endTime.setHours(17, 0, 0, 0); // 5:00 PM        // Loop through the time slots in 15-minute intervals        while (startTime < endTime) {            // Skip past the 1:00 PM to 2:00 PM range            if (startTime.getHours() === 13) {                startTime.setHours(14, 0, 0, 0); // Skip to 2:00 PM                continue;            }            var endSlot = new Date(startTime.getTime() + 15 * 60000); // Add 15 minutes            // Skip past time slots            if (startTime.getTime() < new Date().getTime()) {                startTime = endSlot; // Move to the next slot                continue;            }            var timeRange = formatTime(startTime) + " - " + formatTime(endSlot);            var option = document.createElement("option");            option.value = timeRange;            option.text = timeRange;            dropdown.appendChild(option);            startTime = endSlot; // Move to next interval        }    }    // Helper function to format time as "HH:mm AM/PM"    function formatTime(date) {        var hours = date.getHours();        var minutes = date.getMinutes();        var ampm = hours >= 12 ? 'PM' : 'AM';        hours = hours % 12;        hours = hours ? hours : 12;  // 12 AM is 12, 0 hours is 12        minutes = minutes < 10 ? '0' + minutes : minutes;        return hours + ':' + minutes + ' ' + ampm;    }</script>